{% extends "base.html" %}

{% block title %}{{ exercise.name }}{% endblock %}

{% block content %}
<div class="exercise-detail">
    <a href="{{ url_for('main.home') }}" class="back-button">‚Üê Back to Routine</a>

    <h2>{{ exercise.name }}</h2>

    <div class="exercise-info">
        <div class="info-card">
            <h3>Sets</h3>
            <p>{{ exercise.sets }}</p>
        </div>

        <div class="info-card">
            <h3>Reps</h3>
            <p>{{ exercise.reps }}</p>
        </div>
    </div>

    <div class="exercise-description">
        <h3>Description</h3>
        <p>{{ exercise.description }}</p>
    </div>

    <div class="timer-section">
        <h3>Rest Timer</h3>
        <div class="timer-display">00:00</div>
        <div class="timer-controls">
            <button id="timer-90" class="timer-btn">90s</button>
            <button id="timer-120" class="timer-btn">2min</button>
            <button id="timer-180" class="timer-btn">3min</button>
            <button id="timer-start" class="timer-btn primary">Start</button>
            <button id="timer-reset" class="timer-btn">Reset</button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Timer functionality will be added here
    document.addEventListener('DOMContentLoaded', function() {
        const timerDisplay = document.querySelector('.timer-display');
        const startBtn = document.getElementById('timer-start');
        const resetBtn = document.getElementById('timer-reset');
        const timer90Btn = document.getElementById('timer-90');
        const timer120Btn = document.getElementById('timer-120');
        const timer180Btn = document.getElementById('timer-180');

        let countdown;
        let timeLeft = 90;
        let isRunning = false;

        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function startTimer() {
            if (isRunning) return;

            isRunning = true;
            startBtn.textContent = 'Pause';

            countdown = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();

                if (timeLeft <= 0) {
                    clearInterval(countdown);
                    timerDisplay.textContent = 'DONE!';
                    startBtn.textContent = 'Start';
                    isRunning = false;

                    // Play sound or vibrate
                    if ('vibrate' in navigator) {
                        navigator.vibrate([200, 100, 200]);
                    }
                }
            }, 1000);
        }

        function pauseTimer() {
            clearInterval(countdown);
            isRunning = false;
            startBtn.textContent = 'Resume';
        }

        function resetTimer() {
            clearInterval(countdown);
            isRunning = false;
            startBtn.textContent = 'Start';
            timeLeft = 90;
            updateTimerDisplay();
        }

        startBtn.addEventListener('click', function() {
            if (isRunning) {
                pauseTimer();
            } else {
                startTimer();
            }
        });

        resetBtn.addEventListener('click', resetTimer);

        timer90Btn.addEventListener('click', function() {
            timeLeft = 90;
            updateTimerDisplay();
        });

        timer120Btn.addEventListener('click', function() {
            timeLeft = 120;
            updateTimerDisplay();
        });

        timer180Btn.addEventListener('click', function() {
            timeLeft = 180;
            updateTimerDisplay();
        });

        // Initialize timer display
        updateTimerDisplay();
    });
</script>
{% endblock %}
